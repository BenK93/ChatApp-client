(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{107:function(e,t,a){e.exports=a(241)},112:function(e,t,a){},233:function(e,t){},236:function(e,t,a){},237:function(e,t,a){},238:function(e,t,a){},239:function(e,t,a){},240:function(e,t,a){},241:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(7),o=a.n(r),c=a(26),m=a(3),i=a(18),u=a(19),l=a(21),d=a(20),p=a(59),N=a.n(p),h=(a(112),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleClick=function(e){var t=n.state,a=t.userName,s=t.roomName;a&&s||e.preventDefault()},n.handleKeyDown=function(e){var t=n.state,a=t.userName,s=t.roomName;if(13===e.keyCode)return a?s?void n.props.history.push(n.getRedirectedLink()):(n.setState({isRoomValid:!1}),void n.inputRoom.focus()):(n.setState({isNameValid:!1}),void n.inputName.focus())},n.state={userName:"",roomName:"",isNameValid:!0,isRoomValid:!0},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"getRedirectedLink",value:function(){var e=this.state,t=e.userName,a=e.roomName;return"/chat?userName=".concat(t,"&roomName=").concat(a)}},{key:"render",value:function(){var e=this,t=this.state,a=t.isNameValid,n=t.isRoomValid;return s.a.createElement("div",{className:"join-component"},s.a.createElement("div",{className:"join-title"},"Join"),s.a.createElement("div",{className:"join-container"},s.a.createElement("div",{className:"input-container"},s.a.createElement("input",{className:N()("join-input",{invalid:!a}),placeholder:"Name",onChange:function(t){e.setState({isNameValid:!0,userName:t.target.value})},ref:function(t){return e.inputName=t}}),s.a.createElement("input",{className:N()("join-input",{invalid:!n}),placeholder:"Room",onChange:function(t){e.setState({isRoomValid:!0,roomName:t.target.value})},ref:function(t){return e.inputRoom=t}})),s.a.createElement(c.b,{className:"enter-button-link",onClick:function(t){return e.handleClick(t)},to:this.getRedirectedLink()},s.a.createElement("div",{className:"enter-button"},"ENTER"))))}}]),a}(n.PureComponent)),f=a(11),v=a.n(f),g=a(22),E=a(15),b=a(62),y=a.n(b),k=a(102),j=a.n(k),w=a(103),O=a.n(w),U=(a(236),a(237),a(105)),M=a(260),x=Object(U.a)((function(e){return{tooltip:{backgroundColor:e.palette.common.white,color:"rgba(0, 0, 0, 0.87)",boxShadow:e.shadows[1],fontSize:12}}}))(M.a),S=function(){return s.a.createElement("div",{className:"header-component"},s.a.createElement(x,{title:"Log Out",placement:"right"},s.a.createElement(c.b,{to:"/"},s.a.createElement("button",{className:"back-button"},s.a.createElement("i",{className:"fas fa-arrow-left fa-2x"})))))},C=a(63),D=a.n(C),R=(a(238),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).addUser=function(e){var t=n.state.userNames;e.roomName===n.props.room.roomName&&n.setState({userNames:D()([].concat(Object(E.a)(t),Object(E.a)(e.existingUserNames),[e.userName]))})},n.removeUser=function(e){var t=n.state.userNames,a=e.userName;if(e.roomName===n.props.room.roomName){var s=t.indexOf(a),r=t;r.splice(s),n.setState({userNames:Object(E.a)(r)})}},n.getUserNames=Object(g.a)(v.a.mark((function e(){var t,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:5000/rooms/getRoom/".concat(n.props.room.roomName));case 2:return t=e.sent,e.next=5,t.json();case 5:if(a=e.sent){e.next=8;break}return e.abrupt("return");case 8:n.setState({userNames:D()([].concat(Object(E.a)(n.state.userNames),Object(E.a)(a.userNames)))});case 9:case"end":return e.stop()}}),e)}))),n.state={userNames:n.props.room.userNames},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.getUserNames(),T.on("user joined",this.addUser),T.on("user left",this.removeUser)}},{key:"componentWillUnmount",value:function(){T.off("user joined",this.addUser),T.off("user left",this.removeUser)}},{key:"renderUserNames",value:function(){var e=this;return this.state.userNames.map((function(t,a){return t===e.props.userName?s.a.createElement("div",{className:"participant-name",key:a},s.a.createElement("b",null,t," (Me)")):s.a.createElement("div",{className:"participant-name",key:a},t)}))}},{key:"render",value:function(){var e=this.props.room;return s.a.createElement("div",{className:"left-menu-component"},s.a.createElement("div",{className:"room-container"},s.a.createElement("h2",{className:"header"},"Room Name:"),s.a.createElement("h2",{className:"header room"},e?e.roomName:"")),s.a.createElement("div",{className:"participants-container"},s.a.createElement("h2",{className:"header"},"Participants:"),s.a.createElement("div",{className:"items-wrapper"},this.renderUserNames())))}}]),a}(n.PureComponent)),L=(a(239),function(e){var t=e.message,a=e.isSelf,n=new Date(t.date);return a?s.a.createElement("div",{className:"message-component aligned-right"},s.a.createElement("div",{className:"message-sender"},s.a.createElement("b",null,t.userName),s.a.createElement("br",null),n.getHours(),":",(n.getMinutes()<10?"0":"")+n.getMinutes()),s.a.createElement("div",{className:"message-content aligned-right"},t.content)):s.a.createElement("div",{className:"message-component"},s.a.createElement("div",{className:"message-content"},t.content),s.a.createElement("div",{className:"message-sender"},s.a.createElement("b",null,t.userName),s.a.createElement("br",null),n.getHours(),":",(n.getMinutes()<10?"0":"")+n.getMinutes()))}),V=(a(240),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleKeyDown=function(e){n.keys[e.keyCode]=!0,n.keys[13]&&!n.keys[16]&&(e.preventDefault(),n.sendMessage())},n.handleKeyUp=function(e){delete n.keys[e.keyCode]},n.sendMessage=Object(g.a)(v.a.mark((function e(){var t,a,s,r,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.content,a=n.props,s=a.userName,r=a.roomName,t){e.next=4;break}return e.abrupt("return");case 4:return o={userName:s,content:t,roomName:r,date:new Date},document.getElementById("text-input").value="",e.next=8,fetch("http://localhost:5000/messages/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 8:n.setState({content:null});case 9:case"end":return e.stop()}}),e)}))),n.keys=[],n.state={content:null},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)}},{key:"setContent",value:function(e){this.setState({content:e})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"text-component"},s.a.createElement("textarea",{id:"text-input",type:"text",placeholder:"Type your message here...",onChange:function(t){return e.setContent(t.target.value)}}),s.a.createElement(x,{title:"Send Message",placement:"top"},s.a.createElement("button",{className:"icon-button send",onClick:this.sendMessage},s.a.createElement("i",{className:"fas fa-paper-plane fa-lg"}))))}}]),a}(n.PureComponent)),K="http://100.24.236.188",T=O()(K),P=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).getMessage=function(e){n.addMessage(e)},n.addMessage=function(e){var t=n.state.messages;n.setState({messages:y()([].concat(Object(E.a)(t),[e]),"_id")})},n.AddNewUserMessage=function(e){if(n.userName!==e.userName&&n.roomName===e.roomName){var t={userName:e.userName,content:"".concat(e.userName," joined the room!"),date:new Date};n.setState({messages:y()([].concat(Object(E.a)(n.state.messages),[t]),"content")})}},n.removeUser=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(K,"/rooms/removeUser"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomName:n.roomName,userName:n.userName})});case 2:case"end":return e.stop()}}),e)}))),n.renderMessage=function(e,t){return s.a.createElement(L,{key:t,message:e,isSelf:n.userName===e.userName})},n.setGlobalVariables(),n.state={messages:[{userName:n.roomName,content:"Hi ".concat(n.userName,", welcome to chat!"),date:new Date}],room:{roomName:n.roomName,userNames:[n.userName]}},n}return Object(u.a)(a,[{key:"setGlobalVariables",value:function(){var e=j.a.parse(this.props.location.search),t=e.userName,a=e.roomName;this.userName=t,this.roomName=a,this.joinDate=new Date}},{key:"componentDidMount",value:function(){var e=this;this.createRoom(),window.onbeforeunload=function(t){t.preventDefault(),e.removeUser()},T.on("user joined",this.AddNewUserMessage),T.on("message sent",this.getMessage)}},{key:"componentDidUpdate",value:function(e){e.messages!==this.state.messages&&(this.scrollableElement.scrollTop=this.scrollableElement.scrollHeight)}},{key:"componentWillUnmount",value:function(){this.removeUser(),T.off("message sent",this.getMessage),T.off("user joined",this.AddNewUserMessage)}},{key:"createRoom",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t,a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("in create room"),t={roomName:this.roomName,userName:this.userName},e.next=4,fetch("".concat(K,"/rooms/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 4:return a=e.sent,e.next=7,a.json();case 7:n=e.sent,this.setState({room:n});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderMessages",value:function(){return this.state.messages.map(this.renderMessage)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"chat-component"},s.a.createElement("div",{className:"outer-chat-container"},s.a.createElement("div",{className:"header-component-wrapper"},s.a.createElement(S,null)),s.a.createElement("div",{className:"inner-chat-container"},s.a.createElement("div",{className:"left-menu-component-wrapper"},s.a.createElement(R,{room:this.state.room,userName:this.userName,socket:T})),s.a.createElement("div",{className:"inner-chat"},s.a.createElement("div",{id:"messages-component-wrapper",ref:function(t){return e.scrollableElement=t}},s.a.createElement("div",{id:"messages-container"},this.renderMessages())),s.a.createElement("div",{className:"text-component-wrapper"},s.a.createElement(V,{userName:this.userName,roomName:this.roomName}))))))}}]),a}(n.PureComponent),J=function(){return s.a.createElement(c.a,null,s.a.createElement(m.a,{path:"/",exact:!0,component:h}),s.a.createElement(m.a,{path:"/chat",component:P}))};o.a.render(s.a.createElement(J,null),document.querySelector("#root"))}},[[107,1,2]]]);
//# sourceMappingURL=main.ba682b5b.chunk.js.map